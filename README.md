# backend_backspeen

Данное backend-приложение реализовано с использованием FastAPI и представляет собой систему с собственной реализацией аутентификации и авторизации. 
Реализована система управления доступом к ресурсам.

Ключевые особенности

Пользователи проходят процедуру регистрации, логина и получают права доступа согласно своим ролям (admin/user/moderator).
Система аутентификации и авторизации.
Пользователи могут обновлять свои данные.
"Мягкое" удаление пользователей (при удалении пользователя происходит logout, пользователь больше не может залогиниться, но при этом в БД остается запись со статусом is_active=False).

База данных представляет собой две таблицы:
1. Пользователи (содержит информацию о пользователях и ролях)
2. Сессии (временно хранит информацию о сессиях пользователей)

Схема структуры управления доступом:

На эндпоинте login генерируется и схраняется в базу ID сессии. 
Так же создается jwt-токен подающийся в заголовки клиента для аутентификации.

Далее при каждой попытке доступа к любому ресурсу происходит проверка прав пользователя.

Проверка учитывает:

* Текущий jwt-токен (вам потребуется secret_key для декодирования токена).
* Сопоставление текущей сессии с session_id из БД.
* Наличие необходимой роли у пользователя.
* Временные ограничения.

При logout и/или удалении пользователя из БД удаляется и текущая сессия. Соответственно после этого пройти проверку пользователь не может.
При удалении пользователя в БД остается запись со статусом is_active=False.


Используемые технологии и библиотеки:

* FastAPI
— веб-фреймворк для создания API.
* aiohttp
— библиотека для асинхронной работы с http-сервером.
* Tortoise ORM
— ORM для работы с базой данных.
* СУБД: SQLite

_______________________________________
ИСПОЛЬЗОВАНИЕ

Вам потребуются библиотеки из файла requirements.txt (pip install -r requirements.txt)
Запуск сервера происходит в файле run_server.py.
Для демонстрации работы приложения необходимо запустить сценарий в файле example.py.
Логгер сценария покажет пошаговое прохождение всех этапов работы.
Логгер со стороны сервера покажет все запросы к нему и ответы.

Для упрощения настройки приложения для первичной демонстрации, некоторые приватные данные размещены в config.py (например secret_key или запись admin). Так же как и некоторые креденшиалсы расположены в example.py. Предполагается дальнейшее использование переменных окружения для сокрытия этих данных.


